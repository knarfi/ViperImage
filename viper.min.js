if("undefined"==typeof ViperImage){var ViperImage=function(a,b){if(initErrors=!1,this.options={infinite:!0,theme:"dark"},this.debug=!1,"array"!=typeof a){this.elements={};for(var c=0;c<a.length;c++)if("undefined"!=typeof a[c].getAttribute("rel")&&""!==a[c].getAttribute("rel")){var d=a[c].getAttribute("rel");"undefined"!=typeof this.elements[d]?this.elements[d].push(a[c]):this.elements[d]=[a[c]]}else"undefined"!=typeof this.elements["viper-default"]?this.elements["viper-default"].push(a[c]):this.elements["viper-default"]=[a[c]];for(elem in this.elements)for(var c=0;c<this.elements[elem].length;c++)this.elements[elem][c].setAttribute("data-viper-image",c);this.debug&&(console.debug("These elements have been found:"),console.debug(this.elements))}else console.warn("ViperImage expects at least an array of elements as an argument"),initErrors=!0;if("object"==typeof b)for(option in b)this.options[option]=b[option];initErrors?this.debug&&console.debug("Terminated because of some initialisation errors."):(this.addStylesToPage(),this.buildElement())};ViperImage.prototype.isActive=function(){var a=document.querySelector(".viper-wrapper");return(" "+a.className+" ").indexOf(" active ")>-1},ViperImage.prototype.addStylesToPage=function(){var a="body.viper-overflow{overflow:hidden;}.viper-wrapper{opacity:0;visibility:hidden;-webkit-transition:.2s;transition:.2s}.viper-wrapper *{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.viper-wrapper.active{opacity:1;visibility:visible}.viper-background,.viper-content{display:block;background:rgba(15,15,15,.9);position:fixed;left:0;right:0;top:0;bottom:0;font-size:13px}.viper-wrapper.viper-light .viper-background{background:rgba(255,255,255,.9)}.viper-content{background:0 0}.viper-close,.viper-count{color:#fff;position:fixed;top:20px;cursor:pointer}.viper-wrapper.viper-light .viper-close{color:rgba(15,15,15,.9)}.viper-close{right:20px;-webkit-transition:.2s;transition:.2s}.viper-close:hover{color:#fff}.viper-count{color:rgba(255,255,255,.7);left:20px}.viper-wrapper.viper-light .viper-count{color:rgba(15,15,15,.7)}.viper-arrow-left,.viper-arrow-right{color:rgba(255,255,255,.6);font-size:24px;display:block;width:36px;height:36px;background:rgba(255,255,255,.1);border-radius:100%;line-height:30px;text-align:center;-webkit-transition:.2s;transition:.2s;cursor:pointer;position:fixed;top:50%;margin-top:-18px}.viper-wrapper.viper-light .viper-arrow-left,.viper-wrapper.viper-light .viper-arrow-right{color:rgba(15,15,15,.6);background:rgba(15,15,15,.1)}.viper-wrapper.viper-light .viper-arrow-left:hover,.viper-wrapper.viper-light .viper-arrow-right:hover{background:rgba(15,15,15,.5);color:rgba(15,15,15,1)}.viper-arrow-left:hover,.viper-arrow-right:hover{background:rgba(255,255,255,.5);color:#fff}.viper-arrow-left{left:20px}.viper-arrow-right{right:20px}@media (max-width:768px){.viper-arrow-left,.viper-arrow-right{color:transparent!important;width:40%;top:50px;bottom:80px;background:0 0!important;border-radius:0;-webkit-transition:.2s;transition:.2s;margin-top:0;height:auto}.viper-arrow-left{left:0}.viper-arrow-right{right:0}.viper-arrow-left:hover,.viper-arrow-right:hover{background:0 0;color:transparent}}.viper-image-holder{position:fixed;top:50px;bottom:80px;left:0;right:0;pointer-events:none;background-size:contain;background-position:center center;background-repeat:no-repeat;-webkit-transition:.2s;transition:.2s}.viper-image-holder.fadeout{opacity:0}.viper-captions{position:fixed;bottom:0;height:60px;left:0;right:0;color:#fff;text-align:center}.viper-captions .viper-description{color:rgba(255,255,255,.8)}.viper-captions .viper-author{color:rgba(255,255,255,.5);font-size:11px}.viper-wrapper.viper-light .viper-captions .viper-description{color:rgba(15,15,15,.8)}.viper-wrapper.viper-light .viper-captions .viper-author{color:rgba(15,15,15,.5)}",b=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a)),b.appendChild(c)},ViperImage.prototype.buildElement=function(){var a='<div class="viper-wrapper"> <div class="viper-background"></div> <div class="viper-content"> <div class="viper-close">&#x2573;</div> <div class="viper-count"> <span class="viper-current"></span> / <span class="viper-total"></span> </div> <div class="viper-image-holder"></div> <div class="viper-arrow-left"> &#x2039; </div> <div class="viper-arrow-right"> &#x203A; </div> <div class="viper-captions"> <div class="viper-description"></div> <div class="viper-author"></div> </div> </div> </div>';document.body.innerHTML+=a,this.addBindings()},ViperImage.prototype.addBindings=function(){this.addCloseBindings(),this.addArrowButtonBindings(),this.addSwipeBindings(),this.addKeyboardBindings(),this.addThumbnailBindings()},ViperImage.prototype.addCloseBindings=function(){var a=document.querySelector(".viper-background"),b=document.querySelector(".viper-close"),c=document.querySelector(".viper-wrapper");a.addEventListener("click",function(){c.classList.remove("active"),document.body.classList.remove("viper-overflow")}),b.addEventListener("click",function(){c.classList.remove("active"),document.body.classList.remove("viper-overflow")})},ViperImage.prototype.addArrowButtonBindings=function(){var a=document.querySelector(".viper-arrow-left"),b=document.querySelector(".viper-arrow-right"),c=this;a.addEventListener("click",function(){c.prevImage()}),b.addEventListener("click",function(){c.nextImage()})},ViperImage.prototype.addSwipeBindings=function(){var a=this;window.addEventListener("touchstart",function(c){a.isActive()&&(a.xDown=c.touches[0].clientX,a.yDown=c.touches[0].clientY)},!1),window.addEventListener("touchmove",function(c){if(a.isActive()){if(!a.xDown||!a.yDown)return;var d=c.touches[0].clientX,e=c.touches[0].clientY,f=a.xDown-d,g=a.yDown-e;Math.abs(f)+Math.abs(g)>150&&(Math.abs(f)>Math.abs(g)&&(f>0?a.nextImage():a.prevImage()),a.xDown=null,a.yDown=null)}},!1)},ViperImage.prototype.addThumbnailBindings=function(){var a=this,b=document.querySelector(".viper-wrapper");for(gallery in this.elements)for(var c=0;c<this.elements[gallery].length;c++)this.event(this.elements[gallery][c],"click",function(c){return c.preventDefault(),b.classList.add("active"),document.body.classList.add("viper-overflow"),"light"==a.options.theme?b.classList.add("viper-light"):b.classList.remove("viper-light"),this.debug&&console.debug(a),a.setActive(this,!0),!1})},ViperImage.prototype.addKeyboardBindings=function(){window.addEventListener("keydown",function(a){37==a.which&&_this.isActive()?_this.prevImage():39==a.which&&_this.isActive()&&_this.nextImage()})},ViperImage.prototype.getGallery=function(a){var b=null;return b="undefined"==typeof a?this.activeImage:a,"undefined"!=typeof b.getAttribute("rel")&&""!==b.getAttribute("rel")?b.getAttribute("rel"):"viper-default"},ViperImage.prototype.event=function(a,b,c){document.addEventListener(b,function(b){b.preventDefault();for(var d=b.target;d&&d!=this;d=d.parentNode)if(d.isEqualNode(a)){c.call(d,b);break}},!1)},ViperImage.prototype.setActive=function(a,b){var c=document.querySelector(".viper-image-holder"),d="URL('"+a.href+"');",e=document.querySelector(".viper-current"),f=document.querySelector(".viper-total"),g=document.querySelector(".viper-description"),h=document.querySelector(".viper-author"),i=this.getGallery(a);this.activeImage=a,this.debug&&(console.debug("New image is being activated"),console.debug(a),console.debug(d)),c.setAttribute("style","background-image: "+d),e.innerText=parseInt(a.getAttribute("data-viper-image"))+1,f.innerText=this.elements[i].length,"undefined"!=typeof a.getAttribute("data-viper-title")&&""!=a.getAttribute("data-viper-title")?g.innerText=a.getAttribute("data-viper-title"):g.innerText="","undefined"!=typeof a.getAttribute("data-viper-author")&&""!=a.getAttribute("data-viper-author")?h.innerText=a.getAttribute("data-viper-author"):h.innerText=""},ViperImage.prototype.nextImage=function(){var a=parseInt(this.activeImage.getAttribute("data-viper-image")),b=this.elements[this.getGallery()];this.debug&&(console.debug("nextImage"),console.debug(a)),a<b.length-1?this.setActive(b[++a],!1):this.options.infinite&&this.setActive(b[0],!1)},ViperImage.prototype.prevImage=function(){var a=parseInt(this.activeImage.getAttribute("data-viper-image")),b=this.elements[this.getGallery()];this.debug&&(console.debug("prevImage"),console.debug(a)),a>0?this.setActive(b[--a],!1):this.options.infinite&&this.setActive(b[b.length-1],!1)}}else console.warn('Could not initialize name "ViperImage". The name is already in use.');
